<!--pages/commentPage/commentPage.wxml-->
<view>
  <!--普通评论区-->
  <view class='header'>
    <view>
      评论({{total}})
    </view>
  </view>
  <view class='commentArea'>
    <!--一条评论-->
    <view class='comment' wx:key="{{index}}" wx:for="{{commentList}}">  
      <view class='comment2'>
        <!--左侧头像区-->
        <view class='avatarArea' data-openid='{{item.fromUid}}' bindtap='clickUser'>
          <image class='avatar' src='{{item.avatar}}'></image>
        </view>
        <!--右侧具体信息区-->
        <view class='commentRightArea'>
          <view class='userArea'>
            <view class='username' hover-class='hover' data-openid='{{item.fromUid}}' bindtap='clickUser'>
              {{item.username}}
            </view>
            <view class='floor'>
              #{{item.floor}}
            </view>
          </view>
          <!--评论内容-->
          <view class='commentContentArea'  data-commentid='{{item.id}}'  data-content='{{item.content}}' data-type='1' data-username='{{item.username}}' bindtap='showInput' hover-class='hover' bindlongpress='copy'>
            <text>{{item.content}}</text>
          </view>
          <!--操作区-->
          <view class='dealArea'>
            <view class='dealLeft'>
              <view class='date'>{{item.createTime}}</view>
              <view wx:if="{{item.fromUid==openId}}" class='delete' bindtap='deleteComment' data-commentid='{{item.id}}'>删除</view>
            </view>
            <view class='dealRight' data-commentid='{{item.id}}' bindtap='zanDeal'>
              <view class='iconArea'>
                <view class='zanNum'>{{item.zanNum}}</view>
                <image wx:if="{{item.isZan}}" src='../../icons/zan_focus.png' class='Icon'></image>
                <image wx:if="{{!item.isZan}}" src='../../icons/zan.png' class='Icon'></image>
              </view>
            </view>
          </view>
          <!--评论对应的回复区-->
          <view class='replyArea' data-commentid='{{item.commentID}}' bindtap='jumpCommentDetailPage'>
            <!--一条回复-->
            <view class="reply" wx:key="{{index}}" wx:for-item="i" wx:for-index="rindex" wx:for="{{item.replyList}}" hover-class='hover' data-content='{{i.content}}' bindlongpress='copy'>
              <view wx:if="{{item.show | ((item.replyNum==4) & rindex<4) |(!(item.replyNum==4) & rindex<3) }}">
                <text class='username' >{{i.fromUname}}</text>
                <text decode="{{true}}" space="{{true}}" wx:if="{{i.type}}">&nbsp;回复&nbsp;</text>
                <text class='username'>{{i.toUname}}</text>
                <text decode="{{true}}" space="{{true}}">&nbsp;:&nbsp;{{i.content}}</text>
              </view>
            </view>
            <view wx:if="{{item.replyNum>4}}" class='username' hover-class='hover'> 查看全部{{item.replyNum}}条回复</view>
          </view>
        </view>
      </view>
    </view>
    <view>
    </view>
  </view>
  <view class="weui-loadmore" wx:if="{{isHideLoadMore}}">
    <view class="weui-loading"></view>
    <view class="weui-loadmore__tips">正在加载</view>
  </view>
  <view class='bottomArea'></view>
  <view class='inputTips' style='bottom:{{inputArea.bottomH}}rpx'>
    <!--tips-->
    <view style='background-color:#c1c1c1;width:100%;height:3rpx;'></view>
    <view class='tipsArea' wx:if="{{inputArea.sending}}">
      <view class=' inputUser'>评论给 {{inputArea.sendUser}}</view>
    </view>
    <!--聚焦之后展示此框框-->
    <view class='focusInputArea' wx:if="{{inputArea.sending}}">
      <!--当用户点击进入评论时才会弹出此界面-->
      <textarea  placeholder='友善的评论是交流的起点' class='textArea' bindfocus='inputFocus' bindblur='inputUnFocus' auto-focus='true' bindinput='inputing' bindconfirm='sendText' fixed='true' show-confirm-bar='{{false}}' auto-height='{{inputArea.line<4}}' adjust-position="{{false}}" cursor-spacing="30rpx;" bindlinechange="linechange" value="{{inputArea.content}}"></textarea>
    </view>
    <view class='inputArea'><!--纵向居中-->
      <view class="input"><!--横向排列-->
        <!--表情-->
        <view class='emotionArea'>
          <image class='emotion' src='../../icons/emotion.png'></image>
        </view>
        <!--文本框-->
        <view class='textContain'>
          <view class='textTips' data-type='0' bindtap='showInput' wx:if="{{!inputArea.sending}}">{{inputArea.content=="" ? '请输入评论' : inputArea.content}}</view>
        </view>
        <!--发送按钮-->
        <view class='buttonArea' bindtap='sendText'>
          <view class='button' wx:if="{{commentIsNull}}">发送</view>
          <view class='button' wx:if="{{!commentIsNull}}">发送</view>
        </view>
      </view>
    </view>
  </view>
</view>